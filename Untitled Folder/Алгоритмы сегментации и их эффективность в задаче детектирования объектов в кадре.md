# Алгоритмы сегментации и их эффективность в задаче детектирования объектов в кадре. Region growing algorithm. Алгоритм Canny.
## Предобработка фото
![Оригинальное фото](https://github.com/NadBarin/nb/blob/main/Untitled%20Folder/img/4.jpg)
#### Averaging
Данный фильтр делает операцию свёртки на изображении с неким ядром, где свёртка — это вычисление нового значения пикселя, при котором учитываются значения соседних пикселей. Ядро свёртки — это квадратная матрица, где пиксель в центре этой матрицы затем устанавливается как среднее значение всех других пикселей, окружающих его. Для того, чтобы воспользоваться данным размытием достаточно вызвать метод blur(), который принимает изображение и кортеж, с указанием размера ядра. Чем больше размер ядра, тем более размытым будет становиться изображение.
![Averaging фото](https://cloud.mail.ru/public/ayUX/K3ju24MEe)
#### Gaussian
Гауссово размытие похоже на предыдущее размытие, за исключением того, что вместо простого среднего мы теперь используем взвешенное среднее, где соседние пиксели, которые ближе к центральному пикселю, вносят больший «вклад» в среднее. Конечным результатом является то, что наше изображение размыто более естественно.Это размытие реализуется в opencv с помощью функции GaussianBlur(), которая принимает первые два аргумента такие же как и предыдущая функция, а третьим аргументом указываем стандартное отклонение ядра Гаусса. Установив это значение в 0, мы тем самым говорим opencv автоматически вычислять его, в зависимости от размера нашего ядра.
![Gaussian фото](https://cloud.mail.ru/public/EmCn/p5vYcLuZE)
#### Median
В медианном размытии центральный пиксель изображения заменяется медианой всех пикселей в области ядра, в результате чего это размытие наиболее эффективно при удалении шума в стиле «соли». Для того, чтобы применить данный вид размытия, необходимо вызвать функцию medianBlur() и передать туда два параметра: изображение и размер ядра.
![Median фото](https://cloud.mail.ru/public/A82Z/KEyFG73rS)

## Как выглядят чёрно-белые маски с различными размытиями
![Маска на оригинальном фото](https://cloud.mail.ru/public/uUxp/Rh8jX2f9g)
!Маска на Averaging фото](https://cloud.mail.ru/public/NKhg/j7RL4Hv4H)
![Маска на Gaussian фото](https://cloud.mail.ru/public/YHhD/8qixCTChX)
![Маска на Median фото](https://cloud.mail.ru/public/TgmN/HCvizSno6)
Границы выглядят не чёткими, но большая часть шумов невелируется.
## Region growing algorithm
Основная идея увеличения области заключается в группировании пикселей со схожими свойствами для формирования областей. В частности, сначала находим начальный пиксель для каждой области, подлежащей сегментации, в качестве начальной точки роста, а затем выбираем пиксель с теми же или подобными свойствами, что и начальный пиксель в окружающих пикселях (в соответствии с некоторым заранее определенным критерием роста или подобия). Производим слияние с областью, где расположен начальный пиксель. Эти новые пиксели обрабатываются как новые начальные значения для продолжения описанного выше процесса до тех пор, пока не будут включены пиксели, удовлетворяющие условию.
![Region growing на оригинальном фото](https://cloud.mail.ru/public/Xpra/DW9N8Hm3b)
![Region growing на Averaging фото](https://cloud.mail.ru/public/oY3T/NqnFJ1CWD)
![Region growing на Gaussian фото](https://cloud.mail.ru/public/riEu/xx6tK9Khh)
![Region growing на Median фото](https://cloud.mail.ru/public/HAUR/odQg7h7Qf)
Алгоритм работает очень долго и малоэффективен. При увеличении размытия убирает и шумы и важные обьекты. Совсем не подходит. 
## Алгоритм Canny
Алгоритм состоит из пяти отдельных шагов:
1 . Сглаживание. Размытие изображения для удаления шума.
2 . Поиск градиентов. Границы отмечаются там, где градиент изображения приобретает максимальное значение.
3 . Подавление не-максимумов. Только локальные максимумы отмечаются как границы.
4 . Двойная пороговая фильтрация. Потенциальные границы определяются порогами.
5 . Трассировка области неоднозначности. Итоговые границы определяются путём подавления всех краёв, несвязанных с определенными (сильными) границами.
![Canny на оригинальном фото](https://cloud.mail.ru/public/n91K/Lqoa1GSju)
![Canny на Averaging фото](https://cloud.mail.ru/public/Vrdd/7YJsSpvhK)
![Canny на Gaussian фото](https://cloud.mail.ru/public/hGg6/pQ2PY9yY4)
![Canny на Gaussian с большим ядром фото](https://cloud.mail.ru/public/yhcK/8xqrxkNCm)
![Canny на Median фото](https://cloud.mail.ru/public/ZjC7/xSFvNJYXA)
![Canny на Median с большим ядром фото](https://cloud.mail.ru/public/xsp2/dXgRzzaHe)

Видно что остаётся шум, а если увеличивать размытие фото, то будут так же стираться нужные границы. Можно попробовать заливать разными цветами что что можно залить из-за наличия нормальных границ и из этого выделять обьекты, всё остальное оставлять как ненужные шумы, но некоторые обьекты могут потеряться.

